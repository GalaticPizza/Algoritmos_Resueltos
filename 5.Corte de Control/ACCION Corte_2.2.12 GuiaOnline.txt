ACCION Corte_2.2.12 ES  //Brabo,Leonardo
    AMBIENTE

    POBLACION = REGISTRO
        PROVINCIA: AN(15);
        DEPARTAMENTO: AN(15);
        CIUDAD: AN(15);
        BARRIO: AN(30);
        ID_CASA: N(4);
        CANT_HABIT: N(5);
    FR;
    ARCH_PO: Archivo de POBLACION ordenado por PROVINCIA,DEPARTAMENTO,CIUDAD,BARRIO,ID_CASA;
    REG_PO : POBLACION;
    
    SALIDA = REGISTRO
        PROVINCIA: AN(15);
        DEPARTAMENTO: AN(15);
        CANT_HABIT:N(5);
    FR;
    ARCH_SAL: Archivo de SALIDA;
    REG_SAL: SALIDA;
    
    RES_PRO, RES_DEP : AN(15);
    TOTDEP : N(5);

    SUBACCION CORTE_DEPARTAMENTO ES
        REG_SAL.PROVINCIA:= RES_PRO;
        REG_SAL.DEPARTAMENTO:= RES_DEP;
        REG.SAL.CANT_HABIT:= TOTDEP;
        ESCRIBIR(ARCH_SAL,REG_SAL);
        TOTDEP:= 0;
        RES_DEP:=REG_PO.DEPARTAMENTO;
    FSUB;

    SUBACCION CORTE_PROVINCIA ES    
        CORTE_DEPARTAMENTO;
        RES_PRO:= REG_PO.PROVINCIA;
    FSUB;

    PROCESO
    ABRIR E/(ARCH_PO) ABRIR S/(ARCH_SALIDA); 
    LEER (ARCH_PO,REG_PO);
    RES_PRO:= REG_PO.PROVINCIA; RES_DEP:= REG_PO.DEPARTAMENTO;
    TOTDEP:= 0;
    MIENTRAS NFDA(ARCH_PO) HACER
        SI RES_PRO <>  REG_PO.PROVINCIA ENTONCES
            CORTE_PROVINCIA
        SINO 
            SI RES_DEP <> REG_PO.DEPARTAMENTO ENTONCES  
                CORTE_DEPARTAMENTO;
            FS;
        FS;
        TOTDEP:= TOTDEP + CANT_HABIT;
        LEER(ARCH_PO,REG_PO);
    FM
    CORTE_PROVINCIA;
    CERRAR(ARCH_PO); CERRAR(ARCH_SAL);
FIN_ACCION.
    
