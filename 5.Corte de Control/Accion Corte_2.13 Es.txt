Accion Corte_2.13 Es

	AMBIENTE

	FECHA = REGISTRO;
		AA:N(4);
		MM: 1..12;
		DD: 1..31;
	FR;

	REPARACIONES = REGISTRO
		CLAVE: REGISTRO
			COD_SUC: N(5);
			MARCA: AN(30);
			MODELO: N(4);
			COD_T: N(5);
		FR;
		FECHA_REP: FECHA;
		COSTO_REP: N;
	FR;

	ARCH_REP: Archivo de REPARACIONES ordenado por CLAVE;
	REG_REP: REPARACIONES;

	RES_SUC: N(5);
	RES_MARCA: AN(30);
	RES_MOD: N(4);
	RED_T: N(5);

	TOTGEN_REP, TOGEN_COST, TOTSUC_REP, TOSUC_COST, TOTMAR_REP,TOTMAR_COST, TOTMOD_REP,TOTMOD_COST, TOTTRA_REP, TOTTRA_COST: N;

	SUBACCION CORTE_SUC ES
		
		CORTE_MAR;
		ESCRIBIR("DE LA SUCURSAL:", RES_SUC);
		ESCRIBIR("La cantidad de  reparaciones que se hizo fue:", TOTSUC_REP);
		ESCRIBIR("El costo total de la sucursal es:", TOTSUC_COST);
		TOTGEN_REP:= TOTGEN_REP + TOTSUC_REP;
		TOTGEN_COST:= TOTGEN_COST + TOTSUC_COST;
		RES_SUC:= REG_REP.CLAVE.COD_SUC;
		TOTSUC_REP:=0;
		TOTSUC_COST:= 0;
	FSUB;


	SUBACCION CORTE_MAR ES

		CORTE_MOD;
		ESCRIBIR("De la marca:",RES_MARCA),
		ESCRIBIR("La cantidad de reparaciones que se hizo fue:", TOTMAR_REP);
		ESCIBIR("El costo total de la marca es:",TOTMAR_COST);
		TOTSUC_REP:= TOTSUC_REP + TOTMAR_REP;
		TOTSUC_COST:= TOTSUC_COSTO + TOTMAR_COST;
		RES_MARCA:= REG_REP.CLAVE.MARCA;
		TOTMAR_REP:= 0;
		TOTMAR_COST:= 0;
	FSUB;

	SUBACCION CORTE_MOD ES

		CORTE_TRAG;
		ESCRIBIR("Del modelo:", RES_MOD);
		ESCRIBIR("La cantidad de reparaciones que se hizo fue:", TOTMOD_REP);
		ESCRIBIR("El costo total por el modelo es:",TOTMOD_COST);
		TOTMAR_REP:= TOTMAR_REP + TOTMOD_REP;
		TOTMAR_COST:= TOTMAR_COST + TOTMOD_COST;
		RES_MOD:= REG_REP.CLAVE.MODELO;
		TOTMOD_REP:= 0;
		TOTMOD_COST:= 0;
	FSUB;

	SUBACCION CORTE_TRAG ES

		ESCRIBIR("Para el tragamonedas:", RES_T);
		ESCRIBIR("La cantidad de reparaciones es:", TOTTRA_REP);
		ESCRIBIR("El costo es de:", TOTTRA_COST);
		TOTMOD_REP:= TOTMOD_REP + TOTTRA_REP;
		TOTMOD_COST:= TOTMOD_COST + TOTRA_COST;
		RES_T:= REG_REP.CLAVE.COD_T;
		TOTTRA_REP:= 0;
		TOTTRA_COST:= 0;
	FSUB;

	PROCESO

	ABRIR E/(ARCH_REP); LEER(ARCH_REP, REG_REP);
	RES_SUC:= REG_REP.CLAVE.COD_SUC;
	RES_MARCA:= REG_REP.CLAVE.MARCA;
	RES_MOD:= REG_REP.CLAVE.MODELO;
	RED_T:= REG_REP.CLAVE.COD_T;

	TOTGEN_REP:=0;TOTGEN_COST:=0; TOTSUC_REP:=0;TOTSUC_COST:=0; TOTMAR_REP:=0;TOTMAR_COST:=0; TOTMOD_REP:=0;
	TOTMOD_COST:=0;TOTTRA_REP:=0; TOTTRA_COST:=0;

	MIENTRAS NFDA(ARCH_REP) HACER
		SI RES_SUC <> REG_REP.CLAVE.COD_SUC ENTONCES
			CORTE_SUC;
		SINO
			SI RES_MARCA <> REG_REP.CLAVE.MARCA ENTONCES
				CORTE_MAR;
			SINO
				SI RES_MOD <> REG_REP.CLAVE.MODELO ENTONCES
					CORTE_MOD;
				SINO
					SI REG_T <> REG_REP.CLAVE.COD_T;
					 	CORTE_TRAG;
					FS;
				FS;
			FS;
		FS;
		TOTTRA_REP:= TOTTTRA_REP + 1;
		TOTTRA_COST:= TOTTRA_COST + REG_REP.COSTO_REP;
		LEER(ARCH_REP, REG_REP);
	FM;
	CORTE_SUC;
	ESCRIBIR("El total general de reparaciones es:", TOTGEN_REP);
	ESCRIBIR("El total general de los costos es:", TOTGEN_COST);
	CERRAR(ARCH_REP);

Fin_Accion.







